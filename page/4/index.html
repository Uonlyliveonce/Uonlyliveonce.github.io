<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"uonlyliveonce.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Wong&#39;s Blog">
<meta property="og:url" content="https://uonlyliveonce.com/page/4/index.html">
<meta property="og:site_name" content="Wong&#39;s Blog">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Wong">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://uonlyliveonce.com/page/4/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Wong's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Wong's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">You only live once!</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-commonweal">

    <a href="/404/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>公益 404</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://uonlyliveonce.com/2017/05/15/2017-05-15-add_property_in_extension_use_runtime/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Wong">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wong's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/05/15/2017-05-15-add_property_in_extension_use_runtime/" class="post-title-link" itemprop="url">Swift 使用runtime给extension添加属性</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-05-15 15:18:43" itemprop="dateCreated datePublished" datetime="2017-05-15T15:18:43+08:00">2017-05-15</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Mobile/" itemprop="url" rel="index"><span itemprop="name">Mobile</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>最近使用swift写新项目，也算是试水，虽然现在swift算是推广起来了，很多大厂小公司的新项目都是swift，但是还是不少坑，这两天写一个waveView就遇到了个这个问题</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2017/05/15/2017-05-15-add_property_in_extension_use_runtime/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://uonlyliveonce.com/2017/05/09/2017-05-09-remove_all_of_subview/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Wong">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wong's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/05/09/2017-05-09-remove_all_of_subview/" class="post-title-link" itemprop="url">iOS 移除所有子视图</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-05-09 10:22:59" itemprop="dateCreated datePublished" datetime="2017-05-09T10:22:59+08:00">2017-05-09</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Mobile/" itemprop="url" rel="index"><span itemprop="name">Mobile</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>有的时候我们会有这样的需求，就是移除所有子视图</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2017/05/09/2017-05-09-remove_all_of_subview/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://uonlyliveonce.com/2017/04/15/2017-04-15-encode_and_decode_use_runtime/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Wong">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wong's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/04/15/2017-04-15-encode_and_decode_use_runtime/" class="post-title-link" itemprop="url">使用runtime进行解档和归档</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-04-15 22:35:36" itemprop="dateCreated datePublished" datetime="2017-04-15T22:35:36+08:00">2017-04-15</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Mobile/" itemprop="url" rel="index"><span itemprop="name">Mobile</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>首先我们先看一下不用runtime的写法，大家可能感觉很简单为什么要用runtime来实现，但是试想一下如果一个对象有很多很多的属性，我们还要一行一行写吗，和从json中给模型赋值一个道理</p>
<h2 id="传统写法"><a href="#传统写法" class="headerlink" title="传统写法"></a>传统写法</h2>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2017/04/15/2017-04-15-encode_and_decode_use_runtime/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://uonlyliveonce.com/2017/04/05/2017-04-05-avoid_repeatedly_click_in_button_use_runtime/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Wong">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wong's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/04/05/2017-04-05-avoid_repeatedly_click_in_button_use_runtime/" class="post-title-link" itemprop="url">使用runtime防止Button暴力点击</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-04-05 20:08:19" itemprop="dateCreated datePublished" datetime="2017-04-05T20:08:19+08:00">2017-04-05</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Mobile/" itemprop="url" rel="index"><span itemprop="name">Mobile</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="按钮防止暴力点击是个很平常的需求，测试时候产品经理、测试同学经常会看哪个按钮不爽，然后使劲戳它。。。"><a href="#按钮防止暴力点击是个很平常的需求，测试时候产品经理、测试同学经常会看哪个按钮不爽，然后使劲戳它。。。" class="headerlink" title="按钮防止暴力点击是个很平常的需求，测试时候产品经理、测试同学经常会看哪个按钮不爽，然后使劲戳它。。。"></a>按钮防止暴力点击是个很平常的需求，测试时候产品经理、测试同学经常会看哪个按钮不爽，然后使劲戳它。。。</h2>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2017/04/05/2017-04-05-avoid_repeatedly_click_in_button_use_runtime/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://uonlyliveonce.com/2017/03/28/2017-03-28-gcd_basic/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Wong">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wong's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/03/28/2017-03-28-gcd_basic/" class="post-title-link" itemprop="url">常用 GCD 笔记(OC / Swift)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-03-28 19:53:58" itemprop="dateCreated datePublished" datetime="2017-03-28T19:53:58+08:00">2017-03-28</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Mobile/" itemprop="url" rel="index"><span itemprop="name">Mobile</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <span id="more"></span>

<h2 id="1-GCD简介"><a href="#1-GCD简介" class="headerlink" title="1. GCD简介"></a>1. GCD简介</h2><blockquote>
<p>什么是GCD呢？我们先来看看百度百科的解释简单了解下概念<br>引自<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/GCD">百度百科</a>Grand Central Dispatch<br> (GCD) 是Apple开发的一个多核编程的较新的解决方法。它主要用于优化应用程序以支持多核处理器以及其他对称多处理系统。它是一个在线程池模式的基础上执行的并行任务。在Mac OS X 10.6雪豹中首次推出，也可在IOS 4及以上版本使用。</p>
</blockquote>
<p><strong>为什么要用GCD呢？</strong><br>因为GCD有很多好处啊，具体如下：</p>
<ul>
<li>GCD可用于多核的并行运算</li>
<li>GCD会自动利用更多的CPU内核（比如双核、四核）</li>
<li>GCD会自动管理线程的生命周期（创建线程、调度任务、销毁线程）</li>
<li>程序员只需要告诉GCD想要执行什么任务，不需要编写任何线程管理代码</li>
</ul>
<h2 id="2-任务和队列"><a href="#2-任务和队列" class="headerlink" title="2. 任务和队列"></a>2. 任务和队列</h2><p><strong>任务</strong>：就是执行操作的意思，换句话说就是你在线程中执行的那段代码。在GCD中是放在block中的。执行任务有两种方式：同步执行和异步执行。两者的主要区别是：是否具备开启新线程的能力。</p>
<ul>
<li>同步执行(sync)：只能在当前线程中执行任务，不具备开启新线程的能力</li>
<li>异步执行(async)：可以在新的线程中执行任务，具备开启新线程的能力</li>
</ul>
<p><strong>队列</strong>：这里的队列指任务队列，即用来存放任务的队列。队列是一种特殊的线性表，采用FIFO（先进先出）的原则，即新任务总是被插入到队列的末尾，而读取任务的时候总是从队列的头部开始读取。每读取一个任务，则从队列中释放一个任务。在GCD中有两种队列：<strong>串行队列</strong>和<strong>并发队列</strong>。</p>
<ul>
<li>并发队列（Concurrent Dispatch Queue）：可以让多个任务并发（同时）执行（自动开启多个线程同时执行任务）<br>并发功能只有在异步（dispatch_async）函数下才有效</li>
<li>串行队列（Serial Dispatch Queue）：让任务一个接着一个地执行（一个任务执行完毕后，再执行下一个任务）</li>
</ul>
<h2 id="3-GCD的使用"><a href="#3-GCD的使用" class="headerlink" title="3. GCD的使用"></a>3. GCD的使用</h2><h5 id="创建队列"><a href="#创建队列" class="headerlink" title="创建队列"></a>创建队列</h5><h6 id="串行并行队列"><a href="#串行并行队列" class="headerlink" title="串行并行队列"></a>串行并行队列</h6><p><code>Swift</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// label:队列标签</span><br><span class="line">// qos:设置队列的优先级</span><br><span class="line">// attributes:队列形式：默认串行，设置为.concurrent代表是并行队列</span><br><span class="line">let queue = DispatchQueue(label: &quot;queue&quot;, qos: .default, attributes: .concurrent)</span><br><span class="line">//创建一个默认串行队列</span><br><span class="line">let queue = DispatchQueue(label: &quot;queue&quot;)</span><br><span class="line">//创建一个有优先级的串行队列</span><br><span class="line">let queue = DispatchQueue(label: &quot;queue&quot;, qos: .background)</span><br></pre></td></tr></table></figure>
<p><code>OC</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//参数1：队列的唯一标识符，用于DEBUG，可为空</span><br><span class="line">//参数2：用来识别是串行队列还是并发队列</span><br><span class="line">// 并发队列</span><br><span class="line">dispatch_queue_t queue= dispatch_queue_create(&quot;queue&quot;, DISPATCH_QUEUE_CONCURRENT);</span><br><span class="line">// 串行队列</span><br><span class="line">dispatch_queue_t queue= dispatch_queue_create(&quot;test.queue&quot;, DISPATCH_QUEUE_SERIAL);</span><br></pre></td></tr></table></figure>
<h6 id="全局队列"><a href="#全局队列" class="headerlink" title="全局队列"></a>全局队列</h6><p><code>Swift</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// 系统的全局队列</span><br><span class="line">let queue = DispatchQueue.global()</span><br><span class="line">let queue = DispatchQueue.global(qos: .default)</span><br></pre></td></tr></table></figure>
<p><code>OC</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//参数1：用来声明优先级</span><br><span class="line">//参数2：预留供将来使用，传递除零以外的任何值可能会导致空返回值，必须为0</span><br><span class="line">dispatch_queue_t queue0 = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);</span><br></pre></td></tr></table></figure>
<h5 id="执行任务"><a href="#执行任务" class="headerlink" title="执行任务"></a>执行任务</h5><p>我们先看一下这个表格，我们将按照这个表格顺序撰写一下示例代码</p>
<table>
<thead>
<tr>
<th></th>
<th>并发队列</th>
<th>串行队列</th>
<th>主队列</th>
</tr>
</thead>
<tbody><tr>
<td>同步(sync)</td>
<td>没有开启新线程，串行执行任务</td>
<td>没有开启新线程，串行执行任务</td>
<td>没有开启新线程，串行执行任务</td>
</tr>
<tr>
<td>异步(async)</td>
<td>有开启新线程，并发执行任务</td>
<td>有开启新线程(1条)，串行执行任务</td>
<td>没有开启新线程，串行执行任务</td>
</tr>
</tbody></table>
<h6 id="并行队列-同步执行"><a href="#并行队列-同步执行" class="headerlink" title="并行队列+同步执行"></a>并行队列+同步执行</h6><p><code>Swift</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">func syncConcurrent() -&gt; Void &#123;</span><br><span class="line">        </span><br><span class="line">        print(&quot;syncConcurrent---begin&quot;)</span><br><span class="line">        </span><br><span class="line">        let queue = DispatchQueue(label: &quot;queue&quot;, attributes: .concurrent)</span><br><span class="line">        </span><br><span class="line">        queue.sync &#123;</span><br><span class="line">            for i in 1...3 &#123;</span><br><span class="line">                print(&quot;111-----\(i)--\(Thread.current)&quot;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        queue.sync &#123;</span><br><span class="line">            for i in 1...3 &#123;</span><br><span class="line">                print(&quot;222-----\(i)--\(Thread.current)&quot;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        queue.sync &#123;</span><br><span class="line">            for i in 1...3 &#123;</span><br><span class="line">                print(&quot;333-----\(i)--\(Thread.current)&quot;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        print(&quot;syncConcurrent---end&quot;)</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p><code>OC</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">- (void) syncConcurrent&#123;</span><br><span class="line">    </span><br><span class="line">    NSLog(@&quot;syncConcurrent---begin&quot;);</span><br><span class="line">    </span><br><span class="line">    dispatch_queue_t queue= dispatch_queue_create(&quot;queue&quot;, DISPATCH_QUEUE_CONCURRENT);</span><br><span class="line">    </span><br><span class="line">    dispatch_sync(queue, ^&#123;</span><br><span class="line">        for (int i = 0; i &lt; 3; ++i) &#123;</span><br><span class="line">            NSLog(@&quot;111------%@&quot; , [NSThread currentThread]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    dispatch_sync(queue, ^&#123;</span><br><span class="line">        for (int i = 0; i &lt; 3; ++i) &#123;</span><br><span class="line">            NSLog(@&quot;222------%@&quot; , [NSThread currentThread]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    dispatch_sync(queue, ^&#123;</span><br><span class="line">        for (int i = 0; i &lt; 3; ++i) &#123;</span><br><span class="line">            NSLog(@&quot;333------%@&quot; , [NSThread currentThread]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    NSLog(@&quot;syncConcurrent---end&quot;);</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>syncConcurrent—begin<br>111—–1–&lt;NSThread: 0x600000073780&gt;{number = 1, name = main}<br>111—–2–&lt;NSThread: 0x600000073780&gt;{number = 1, name = main}<br>111—–3–&lt;NSThread: 0x600000073780&gt;{number = 1, name = main}<br>222—–1–&lt;NSThread: 0x600000073780&gt;{number = 1, name = main}<br>222—–2–&lt;NSThread: 0x600000073780&gt;{number = 1, name = main}<br>222—–3–&lt;NSThread: 0x600000073780&gt;{number = 1, name = main}<br>333—–1–&lt;NSThread: 0x600000073780&gt;{number = 1, name = main}<br>333—–2–&lt;NSThread: 0x600000073780&gt;{number = 1, name = main}<br>333—–3–&lt;NSThread: 0x600000073780&gt;{number = 1, name = main}<br>syncConcurrent—end</p>
</blockquote>
<ul>
<li>打印信息显示，只有一个主线程执行任务，任务串行逐一执行<br>同时我们还可以看到，任务都在打印的begin和end间，说明任务是添加到队列中马上执行的。</li>
</ul>
<h6 id="并行队列-异步执行"><a href="#并行队列-异步执行" class="headerlink" title="并行队列+异步执行"></a>并行队列+异步执行</h6><p><code>Swift</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">func asyncConcurrent() -&gt; Void &#123;</span><br><span class="line">        </span><br><span class="line">        print(&quot;syncConcurrent---begin&quot;)</span><br><span class="line">        </span><br><span class="line">        let queue = DispatchQueue(label: &quot;queue&quot;, attributes: .concurrent)</span><br><span class="line">        </span><br><span class="line">        queue.async &#123;</span><br><span class="line">            for i in 1...3 &#123;</span><br><span class="line">                print(&quot;111-----\(i)--\(Thread.current)&quot;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        queue.async &#123;</span><br><span class="line">            for i in 1...3 &#123;</span><br><span class="line">                print(&quot;222-----\(i)--\(Thread.current)&quot;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        queue.async &#123;</span><br><span class="line">            for i in 1...3 &#123;</span><br><span class="line">                print(&quot;333-----\(i)--\(Thread.current)&quot;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        print(&quot;syncConcurrent---end&quot;)</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p><code>OC</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">- (void) asyncConcurrent&#123;</span><br><span class="line">    </span><br><span class="line">    NSLog(@&quot;asyncConcurrent---begin&quot;);</span><br><span class="line">    </span><br><span class="line">    dispatch_queue_t queue= dispatch_queue_create(&quot;queue&quot;, DISPATCH_QUEUE_CONCURRENT);</span><br><span class="line">    </span><br><span class="line">    dispatch_async(queue, ^&#123;</span><br><span class="line">        for (int i = 0; i &lt; 3; ++i) &#123;</span><br><span class="line">            NSLog(@&quot;111------%@&quot;,[NSThread currentThread]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    dispatch_async(queue, ^&#123;</span><br><span class="line">        for (int i = 0; i &lt; 3; ++i) &#123;</span><br><span class="line">            NSLog(@&quot;222------%@&quot;,[NSThread currentThread]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    dispatch_async(queue, ^&#123;</span><br><span class="line">        for (int i = 0; i &lt; 3; ++i) &#123;</span><br><span class="line">            NSLog(@&quot;333------%@&quot;,[NSThread currentThread]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    NSLog(@&quot;asyncConcurrent---end&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>syncConcurrent—begin<br>syncConcurrent—end<br>111—–1–&lt;NSThread: 0x60000007b4c0&gt;{number = 3, name = (null)}<br>333—–1–&lt;NSThread: 0x60000007b380&gt;{number = 5, name = (null)}<br>222—–1–&lt;NSThread: 0x608000264e00&gt;{number = 4, name = (null)}<br>111—–2–&lt;NSThread: 0x60000007b4c0&gt;{number = 3, name = (null)}<br>222—–2–&lt;NSThread: 0x608000264e00&gt;{number = 4, name = (null)}<br>333—–2–&lt;NSThread: 0x60000007b380&gt;{number = 5, name = (null)}<br>111—–3–&lt;NSThread: 0x60000007b4c0&gt;{number = 3, name = (null)}<br>222—–3–&lt;NSThread: 0x608000264e00&gt;{number = 4, name = (null)}<br>333—–3–&lt;NSThread: 0x60000007b380&gt;{number = 5, name = (null)}</p>
</blockquote>
<ul>
<li>打印信息显示，除了主线程，又开启了4个线程，任务是交替执行。<br>所有任务是在打印的begin和end之后才开始执行的。说明任务不是马上执行，而是将所有任务添加到队列之后才开始异步执行。</li>
</ul>
<h6 id="串行队列-同步执行"><a href="#串行队列-同步执行" class="headerlink" title="串行队列+同步执行"></a>串行队列+同步执行</h6><p><code>Swift</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">func syncSerial() -&gt; Void &#123;</span><br><span class="line">        </span><br><span class="line">        print(&quot;syncSerial---begin&quot;)</span><br><span class="line">        </span><br><span class="line">        let queue = DispatchQueue(label: &quot;queue&quot;)</span><br><span class="line">        </span><br><span class="line">        queue.sync &#123;</span><br><span class="line">            for i in 1...3 &#123;</span><br><span class="line">                print(&quot;111-----\(i)--\(Thread.current)&quot;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        queue.sync &#123;</span><br><span class="line">            for i in 1...3 &#123;</span><br><span class="line">                print(&quot;222-----\(i)--\(Thread.current)&quot;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        queue.sync &#123;</span><br><span class="line">            for i in 1...3 &#123;</span><br><span class="line">                print(&quot;333-----\(i)--\(Thread.current)&quot;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        print(&quot;syncSerial---end&quot;)</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p><code>OC</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">- (void) syncSerial&#123;</span><br><span class="line">    </span><br><span class="line">    NSLog(@&quot;syncSerial---begin&quot;);</span><br><span class="line">    </span><br><span class="line">    dispatch_queue_t queue = dispatch_queue_create(&quot;queue&quot;, DISPATCH_QUEUE_SERIAL);</span><br><span class="line">    </span><br><span class="line">    dispatch_sync(queue, ^&#123;</span><br><span class="line">        for (int i = 0; i &lt; 3; ++i) &#123;</span><br><span class="line">            NSLog(@&quot;111------%@&quot;,[NSThread currentThread]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    dispatch_sync(queue, ^&#123;</span><br><span class="line">        for (int i = 0; i &lt; 3; ++i) &#123;</span><br><span class="line">            NSLog(@&quot;222------%@&quot;,[NSThread currentThread]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    dispatch_sync(queue, ^&#123;</span><br><span class="line">        for (int i = 0; i &lt; 3; ++i) &#123;</span><br><span class="line">            NSLog(@&quot;333------%@&quot;,[NSThread currentThread]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    NSLog(@&quot;syncSerial---end&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>syncSerial—begin<br>111—–1–&lt;NSThread: 0x60800006b7c0&gt;{number = 1, name = main}<br>111—–2–&lt;NSThread: 0x60800006b7c0&gt;{number = 1, name = main}<br>111—–3–&lt;NSThread: 0x60800006b7c0&gt;{number = 1, name = main}<br>222—–1–&lt;NSThread: 0x60800006b7c0&gt;{number = 1, name = main}<br>222—–2–&lt;NSThread: 0x60800006b7c0&gt;{number = 1, name = main}<br>222—–3–&lt;NSThread: 0x60800006b7c0&gt;{number = 1, name = main}<br>333—–1–&lt;NSThread: 0x60800006b7c0&gt;{number = 1, name = main}<br>333—–2–&lt;NSThread: 0x60800006b7c0&gt;{number = 1, name = main}<br>333—–3–&lt;NSThread: 0x60800006b7c0&gt;{number = 1, name = main}<br>syncSerial—end</p>
</blockquote>
<ul>
<li>打印信息显示，所有任务在主线程中执行的，没有开启新线程。而且串行逐一执行。所有任务都在打印的begin和end之间，这说明任务是添加到队列中马上执行的。</li>
</ul>
<h6 id="串行队列-异步执行"><a href="#串行队列-异步执行" class="headerlink" title="串行队列+异步执行"></a>串行队列+异步执行</h6><p><code>Swift</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">func asyncSerial() -&gt; Void &#123;</span><br><span class="line">        </span><br><span class="line">        print(&quot;asyncSerial---begin&quot;)</span><br><span class="line">        </span><br><span class="line">        let queue = DispatchQueue(label: &quot;queue&quot;)</span><br><span class="line">        </span><br><span class="line">        queue.async &#123;</span><br><span class="line">            for i in 1...3 &#123;</span><br><span class="line">                print(&quot;111-----\(i)--\(Thread.current)&quot;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        queue.async &#123;</span><br><span class="line">            for i in 1...3 &#123;</span><br><span class="line">                print(&quot;222-----\(i)--\(Thread.current)&quot;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        queue.async &#123;</span><br><span class="line">            for i in 1...3 &#123;</span><br><span class="line">                print(&quot;333-----\(i)--\(Thread.current)&quot;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        print(&quot;asyncSerial---end&quot;)</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p><code>OC</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">- (void) asyncSerial&#123;</span><br><span class="line">    </span><br><span class="line">    NSLog(@&quot;asyncSerial---begin&quot;);</span><br><span class="line">    </span><br><span class="line">    dispatch_queue_t queue = dispatch_queue_create(&quot;queue&quot;, DISPATCH_QUEUE_SERIAL);</span><br><span class="line">    </span><br><span class="line">    dispatch_async(queue, ^&#123;</span><br><span class="line">        for (int i = 0; i &lt; 3; ++i) &#123;</span><br><span class="line">            NSLog(@&quot;1------%@&quot;,[NSThread currentThread]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    dispatch_async(queue, ^&#123;</span><br><span class="line">        for (int i = 0; i &lt; 3; ++i) &#123;</span><br><span class="line">            NSLog(@&quot;2------%@&quot;,[NSThread currentThread]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    dispatch_async(queue, ^&#123;</span><br><span class="line">        for (int i = 0; i &lt; 3; ++i) &#123;</span><br><span class="line">            NSLog(@&quot;3------%@&quot;,[NSThread currentThread]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    NSLog(@&quot;asyncSerial---end&quot;);</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>asyncSerial—begin<br>asyncSerial—end<br>111—–1–&lt;NSThread: 0x60000007b280&gt;{number = 6, name = (null)}<br>111—–2–&lt;NSThread: 0x60000007b280&gt;{number = 6, name = (null)}<br>111—–3–&lt;NSThread: 0x60000007b280&gt;{number = 6, name = (null)}<br>222—–1–&lt;NSThread: 0x60000007b280&gt;{number = 6, name = (null)}<br>222—–2–&lt;NSThread: 0x60000007b280&gt;{number = 6, name = (null)}<br>222—–3–&lt;NSThread: 0x60000007b280&gt;{number = 6, name = (null)}<br>333—–1–&lt;NSThread: 0x60000007b280&gt;{number = 6, name = (null)}<br>333—–2–&lt;NSThread: 0x60000007b280&gt;{number = 6, name = (null)}<br>333—–3–&lt;NSThread: 0x60000007b280&gt;{number = 6, name = (null)}</p>
</blockquote>
<ul>
<li>打印信息显示，开启了新线程，但是任务串行逐一执行。所有任务是在打印的begin和end之后才开始执行的。说明任务不是马上执行，而是将所有任务添加到队列之后才开始同步执行。</li>
</ul>
<h6 id="主队列-同步执行"><a href="#主队列-同步执行" class="headerlink" title="主队列+同步执行"></a>主队列+同步执行</h6><p><code>Swift</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">func asyncMain() -&gt; Void &#123;</span><br><span class="line">       </span><br><span class="line">       print(&quot;asyncMain---begin&quot;)</span><br><span class="line">       </span><br><span class="line">       let queue = DispatchQueue.main</span><br><span class="line">       </span><br><span class="line">       queue.async &#123;</span><br><span class="line">           for i in 1...3 &#123;</span><br><span class="line">               print(&quot;111-----\(i)--\(Thread.current)&quot;)</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       </span><br><span class="line">       queue.async &#123;</span><br><span class="line">           for i in 1...3 &#123;</span><br><span class="line">               print(&quot;222-----\(i)--\(Thread.current)&quot;)</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       </span><br><span class="line">       queue.async &#123;</span><br><span class="line">           for i in 1...3 &#123;</span><br><span class="line">               print(&quot;333-----\(i)--\(Thread.current)&quot;)</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       </span><br><span class="line">       print(&quot;asyncMain---end&quot;)</span><br><span class="line">       </span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p><code>OC</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">- (void)syncMain&#123;</span><br><span class="line">    </span><br><span class="line">    NSLog(@&quot;syncMain---begin&quot;);</span><br><span class="line">    </span><br><span class="line">    dispatch_queue_t queue = dispatch_get_main_queue();</span><br><span class="line">    </span><br><span class="line">    dispatch_sync(queue, ^&#123;</span><br><span class="line">        for (int i = 0; i &lt; 3; ++i) &#123;</span><br><span class="line">            NSLog(@&quot;1------%@&quot;,[NSThread currentThread]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    dispatch_sync(queue, ^&#123;</span><br><span class="line">        for (int i = 0; i &lt; 3; ++i) &#123;</span><br><span class="line">            NSLog(@&quot;2------%@&quot;,[NSThread currentThread]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    dispatch_sync(queue, ^&#123;</span><br><span class="line">        for (int i = 0; i &lt; 3; ++i) &#123;</span><br><span class="line">            NSLog(@&quot;3------%@&quot;,[NSThread currentThread]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    NSLog(@&quot;syncMain---end&quot;);</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>syncMain—begin<br>(lldb) </p>
</blockquote>
<ul>
<li><p>这时候打印了begin后抛出了crash，当任务加入主线程。而同步执行有个特点，就是对于任务是立马执行的。那么当我们把第一个任务放进主队列中，它就会立马执行。但是主线程现在正在处理syncMain方法，所以任务需要等<code>syncMain</code>执行完才能执行。而<code>syncMain</code>执行到第一个任务的时候，又要等第一个任务执行完才能继续执行。这样互相等待，就造成了死锁，所以我们的任务执行不了，而且end也没有打印。</p>
<h6 id="既然主队列同步执行不成立，我们试一下创建一个并行队列异步执行主队列同步任务"><a href="#既然主队列同步执行不成立，我们试一下创建一个并行队列异步执行主队列同步任务" class="headerlink" title="既然主队列同步执行不成立，我们试一下创建一个并行队列异步执行主队列同步任务"></a>既然主队列同步执行不成立，我们试一下创建一个并行队列异步执行主队列同步任务</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">dispatch_queue_t queue = dispatch_queue_create(&quot;queue&quot;, DISPATCH_QUEUE_CONCURRENT);</span><br><span class="line">    </span><br><span class="line">    dispatch_async(queue, ^&#123;</span><br><span class="line">        [self syncMain];</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>2017-03-28 18:43:14.463 GCDDemo[32024:3326849] syncMain—begin<br>2017-03-28 18:43:14.481 GCDDemo[32024:3326735] 1——&lt;NSThread: 0x608000065c00&gt;{number = 1, name = main}<br>2017-03-28 18:43:14.481 GCDDemo[32024:3326735] 1——&lt;NSThread: 0x608000065c00&gt;{number = 1, name = main}<br>2017-03-28 18:43:14.482 GCDDemo[32024:3326735] 1——&lt;NSThread: 0x608000065c00&gt;{number = 1, name = main}<br>2017-03-28 18:43:14.482 GCDDemo[32024:3326735] 2——&lt;NSThread: 0x608000065c00&gt;{number = 1, name = main}<br>2017-03-28 18:43:14.482 GCDDemo[32024:3326735] 2——&lt;NSThread: 0x608000065c00&gt;{number = 1, name = main}<br>2017-03-28 18:43:14.483 GCDDemo[32024:3326735] 2——&lt;NSThread: 0x608000065c00&gt;{number = 1, name = main}<br>2017-03-28 18:43:14.483 GCDDemo[32024:3326735] 3——&lt;NSThread: 0x608000065c00&gt;{number = 1, name = main}<br>2017-03-28 18:43:14.483 GCDDemo[32024:3326735] 3——&lt;NSThread: 0x608000065c00&gt;{number = 1, name = main}<br>2017-03-28 18:43:14.483 GCDDemo[32024:3326735] 3——&lt;NSThread: 0x608000065c00&gt;{number = 1, name = main}<br>2017-03-28 18:43:14.483 GCDDemo[32024:3326849] syncMain—end</p>
</blockquote>
</li>
<li><p>通过打印信息可以发现，虽然是异步可以开启线程，但是还是在主线程串行执行了任务，所有任务是在打印的begin和end之后才开始执行的。说明任务不是马上执行，而是将所有任务添加到队列之后才开始同步执行。</p>
</li>
</ul>
<h6 id="主队列-异步执行"><a href="#主队列-异步执行" class="headerlink" title="主队列+异步执行"></a>主队列+异步执行</h6><p><code>Swift</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">func asyncMain() -&gt; Void &#123;</span><br><span class="line">        </span><br><span class="line">        print(&quot;asyncMain---begin&quot;)</span><br><span class="line">        </span><br><span class="line">        let queue = DispatchQueue.main</span><br><span class="line">        </span><br><span class="line">        queue.async &#123;</span><br><span class="line">            for i in 1...3 &#123;</span><br><span class="line">                print(&quot;111-----\(i)--\(Thread.current)&quot;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        queue.async &#123;</span><br><span class="line">            for i in 1...3 &#123;</span><br><span class="line">                print(&quot;222-----\(i)--\(Thread.current)&quot;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        queue.async &#123;</span><br><span class="line">            for i in 1...3 &#123;</span><br><span class="line">                print(&quot;333-----\(i)--\(Thread.current)&quot;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        print(&quot;asyncMain---end&quot;)</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p><code>Swift</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">- (void)asyncMain&#123;</span><br><span class="line">    </span><br><span class="line">    NSLog(@&quot;asyncMain---begin&quot;);</span><br><span class="line">    </span><br><span class="line">    dispatch_queue_t queue = dispatch_get_main_queue();</span><br><span class="line">    </span><br><span class="line">    dispatch_async(queue, ^&#123;</span><br><span class="line">        for (int i = 0; i &lt; 3; ++i) &#123;</span><br><span class="line">            NSLog(@&quot;111------%@&quot;,[NSThread currentThread]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    dispatch_async(queue, ^&#123;</span><br><span class="line">        for (int i = 0; i &lt; 3; ++i) &#123;</span><br><span class="line">            NSLog(@&quot;222------%@&quot;,[NSThread currentThread]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    dispatch_async(queue, ^&#123;</span><br><span class="line">        for (int i = 0; i &lt; 3; ++i) &#123;</span><br><span class="line">            NSLog(@&quot;333------%@&quot;,[NSThread currentThread]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    NSLog(@&quot;asyncMain---end&quot;);</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>asyncMain—begin<br>asyncMain—end<br>111—–1–&lt;NSThread: 0x600000066180&gt;{number = 1, name = main}<br>111—–2–&lt;NSThread: 0x600000066180&gt;{number = 1, name = main}<br>111—–3–&lt;NSThread: 0x600000066180&gt;{number = 1, name = main}<br>222—–1–&lt;NSThread: 0x600000066180&gt;{number = 1, name = main}<br>222—–2–&lt;NSThread: 0x600000066180&gt;{number = 1, name = main}<br>222—–3–&lt;NSThread: 0x600000066180&gt;{number = 1, name = main}<br>333—–1–&lt;NSThread: 0x600000066180&gt;{number = 1, name = main}<br>333—–2–&lt;NSThread: 0x600000066180&gt;{number = 1, name = main}<br>333—–3–&lt;NSThread: 0x600000066180&gt;{number = 1, name = main}</p>
</blockquote>
<ul>
<li>所有任务都在主线程中，虽然是异步执行具备开启线程的能力，但因为是主队列，所以所有任务都在主线程中逐一执行。所有任务是在打印的begin和end之后才开始执行的。说明任务不是马上执行，而是将所有任务添加到队列之后才开始同步执行。</li>
</ul>
<h2 id="4-线程间通信"><a href="#4-线程间通信" class="headerlink" title="4.线程间通信"></a>4.线程间通信</h2><p>在开发过程中我们可能把一些耗时的操作放在其他线程执行，但是完成之后需要刷新UI，这时候就要返回主线程刷新UI<br><code>Swift</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">button.setTitle(&quot;-----&quot;, for: .normal)</span><br><span class="line">        let queue = DispatchQueue.global(qos: .default)</span><br><span class="line">        queue.async &#123;</span><br><span class="line">            for i in 0..&lt;3&#123;</span><br><span class="line">                print(&quot;connection\(i)-------\(Thread.current)&quot;)</span><br><span class="line">            &#125;</span><br><span class="line">            DispatchQueue.main.async &#123;</span><br><span class="line">                self.button.setTitle(&quot;线程间通信&quot;, for: .normal)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<p><code>OC</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[_button setTitle:@&quot;-----&quot; forState:(UIControlStateNormal)];</span><br><span class="line">    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</span><br><span class="line">        for (int i = 0; i &lt; 3; ++i) &#123;</span><br><span class="line">            NSLog(@&quot;connection%d------%@&quot;,i,[NSThread currentThread]);</span><br><span class="line">        &#125;</span><br><span class="line">        dispatch_async(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">            [_button setTitle:@&quot;线程间通信&quot; forState:(UIControlStateNormal)];</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>connection0——-&lt;NSThread: 0x608000260940&gt;{number = 3, name = (null)}<br>connection1——-&lt;NSThread: 0x608000260940&gt;{number = 3, name = (null)}<br>connection2——-&lt;NSThread: 0x608000260940&gt;{number = 3, name = (null)}<br>connection——-&lt;NSThread: 0x600000067980&gt;{number = 1, name = main}</p>
</blockquote>
<ul>
<li>打印看到在其他线程中先执行操作，执行完了之后回到主线程执行主线程的相应操作。</li>
</ul>
<h6 id="线程障碍方法"><a href="#线程障碍方法" class="headerlink" title="线程障碍方法"></a>线程障碍方法</h6><p><code>Swift</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">print(&quot;begin&quot;)</span><br><span class="line">        let queue = DispatchQueue(label: &quot;queue&quot;, attributes: .concurrent)</span><br><span class="line">        queue.async &#123;</span><br><span class="line">            print(&quot;111-----\(Thread.current)&quot;)</span><br><span class="line">        &#125;</span><br><span class="line">        queue.async &#123;</span><br><span class="line">            print(&quot;222-----\(Thread.current)&quot;)</span><br><span class="line">        &#125;</span><br><span class="line">        queue.async(group: nil, qos: .default, flags: .barrier) &#123; </span><br><span class="line">            print(&quot;barrier-----\(Thread.current)&quot;)</span><br><span class="line">        &#125;</span><br><span class="line">        queue.async &#123;</span><br><span class="line">            print(&quot;333-----\(Thread.current)&quot;)</span><br><span class="line">        &#125;</span><br><span class="line">        queue.async &#123;</span><br><span class="line">            print(&quot;444-----\(Thread.current)&quot;)</span><br><span class="line">        &#125;</span><br><span class="line">        print(&quot;end&quot;)</span><br></pre></td></tr></table></figure>
<p><code>OC</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">dispatch_queue_t queue = dispatch_queue_create(&quot;queue&quot;, DISPATCH_QUEUE_CONCURRENT);</span><br><span class="line">    </span><br><span class="line">    dispatch_async(queue, ^&#123;</span><br><span class="line">        NSLog(@&quot;111-----%@&quot;, [NSThread currentThread]);</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    dispatch_async(queue, ^&#123;</span><br><span class="line">        NSLog(@&quot;222-----%@&quot;, [NSThread currentThread]);</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    dispatch_barrier_async(queue, ^&#123;</span><br><span class="line">        NSLog(@&quot;----barrier-----%@&quot;, [NSThread currentThread]);</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    dispatch_async(queue, ^&#123;</span><br><span class="line">        NSLog(@&quot;333-----%@&quot;, [NSThread currentThread]);</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    dispatch_async(queue, ^&#123;</span><br><span class="line">        NSLog(@&quot;444-----%@&quot;, [NSThread currentThread]);</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>begin<br>end<br>222—–&lt;NSThread: 0x600000278f00&gt;{number = 3, name = (null)}<br>111—–&lt;NSThread: 0x600000278f40&gt;{number = 4, name = (null)}<br>barrier—–&lt;NSThread: 0x600000278f40&gt;{number = 4, name = (null)}<br>333—–&lt;NSThread: 0x600000278f00&gt;{number = 3, name = (null)}<br>444—–&lt;NSThread: 0x600000278f00&gt;{number = 3, name = (null)}</p>
</blockquote>
<ul>
<li>我们有时需要异步执行两组操作，而且第一组操作执行完之后，才能开始执行第二组操作。这样我们就需要一个相当于障碍一样的一个方法将两组异步执行的操作组给分割起来，当然这里的操作组里可以包含一个或多个任务。</li>
</ul>
<h6 id="延时执行"><a href="#延时执行" class="headerlink" title="延时执行"></a>延时执行</h6><p><code>Swift</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">button.setTitle(&quot;延时&quot;, for: .normal)</span><br><span class="line">        DispatchQueue.main.asyncAfter(deadline: .now() + 2) &#123; </span><br><span class="line">            self.button.setTitle(&quot;线程间通信&quot;, for: .normal)</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<p><code>OC</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[_button setTitle:@&quot;延时&quot; forState:(UIControlStateNormal)];</span><br><span class="line">    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(2.0 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^&#123;</span><br><span class="line">        [_button setTitle:@&quot;线程间通信&quot; forState:(UIControlStateNormal)];</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>
<ul>
<li>当我们需要延迟执行一段代码时，就需要用到GCD的after方法。</li>
</ul>
<h6 id="队列组"><a href="#队列组" class="headerlink" title="队列组"></a>队列组</h6><p><code>Swift</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">let group = DispatchGroup()</span><br><span class="line">       let queue1 = DispatchQueue(label: &quot;queue1&quot;)</span><br><span class="line">       queue1.async(group: group) &#123;</span><br><span class="line">           for i in 1...10 &#123;</span><br><span class="line">               print(&quot;111-----\(i)-----\(Thread.current)&quot;)</span><br><span class="line">           &#125;</span><br><span class="line">           print(&quot;111:\(Thread.current)&quot;)</span><br><span class="line">       &#125;</span><br><span class="line">       let queue2 = DispatchQueue(label:&quot;queue2&quot;)</span><br><span class="line">       group.notify(queue: queue2) &#123;</span><br><span class="line">           queue2.async &#123;</span><br><span class="line">               for i in 1...10 &#123;</span><br><span class="line">                   print(&quot;222-----\(i)-----\(Thread.current)&quot;)</span><br><span class="line">               &#125;</span><br><span class="line">               print(&quot;222:\(Thread.current)&quot;)</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure>
<p><code>OC</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">dispatch_group_t group =  dispatch_group_create();</span><br><span class="line">    dispatch_queue_t queue1 = dispatch_queue_create(&quot;queue1&quot;, DISPATCH_QUEUE_SERIAL);</span><br><span class="line">    dispatch_group_async(group, queue1, ^&#123;</span><br><span class="line">        for (int i = 0; i &lt; 10; i++) &#123;</span><br><span class="line">            NSLog(@&quot;111-----%d-----%@&quot;,i,[NSThread currentThread]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    dispatch_queue_t queue2 = dispatch_queue_create(&quot;queue2&quot;, DISPATCH_QUEUE_SERIAL);</span><br><span class="line">    dispatch_group_notify(group, queue2, ^&#123;</span><br><span class="line">        for (int i = 0; i &lt; 10; i++) &#123;</span><br><span class="line">            NSLog(@&quot;222-----%d-----%@&quot;,i,[NSThread currentThread]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>111—–1—–&lt;NSThread: 0x608000077880&gt;{number = 5, name = (null)}<br>111—–2—–&lt;NSThread: 0x608000077880&gt;{number = 5, name = (null)}<br>111—–3—–&lt;NSThread: 0x608000077880&gt;{number = 5, name = (null)}<br>111:&lt;NSThread: 0x608000077880&gt;{number = 5, name = (null)}<br>222—–1—–&lt;NSThread: 0x60000006fac0&gt;{number = 6, name = (null)}<br>222—–2—–&lt;NSThread: 0x60000006fac0&gt;{number = 6, name = (null)}<br>222—–3—–&lt;NSThread: 0x60000006fac0&gt;{number = 6, name = (null)}<br>222:&lt;NSThread: 0x60000006fac0&gt;{number = 6, name = (null)}</p>
</blockquote>
<ul>
<li>我们经常也会有这样一种需要，一个任务必须在另外一个任务完成后再进行操作，又或者在其他线程中完成任务后，再回到主线程中去刷新UI页面。这时候可以使用队列组来逐一执行任务。</li>
</ul>
<h5 id="demo先呈上，之后继续更新"><a href="#demo先呈上，之后继续更新" class="headerlink" title="demo先呈上，之后继续更新"></a><a target="_blank" rel="noopener" href="https://github.com/uonlyliveonce/GCD_Demo">demo</a>先呈上，之后继续更新</h5>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://uonlyliveonce.com/2017/02/09/2017-02-09-some_problem_regarding_kvc/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Wong">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wong's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/02/09/2017-02-09-some_problem_regarding_kvc/" class="post-title-link" itemprop="url">KVC 遇到的一些问题 O.o?</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-02-09 18:54:06" itemprop="dateCreated datePublished" datetime="2017-02-09T18:54:06+08:00">2017-02-09</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Mobile/" itemprop="url" rel="index"><span itemprop="name">Mobile</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>今天在自己封装控件时候发现一个问题，当我使用KVC和#keyPath发生了一个crash</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2017/02/09/2017-02-09-some_problem_regarding_kvc/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://uonlyliveonce.com/2016/12/18/2016-12-18-umeng_in_swift/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Wong">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wong's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/12/18/2016-12-18-umeng_in_swift/" class="post-title-link" itemprop="url">友盟 Swift 集成的一些注意事项</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2016-12-18 23:38:33" itemprop="dateCreated datePublished" datetime="2016-12-18T23:38:33+08:00">2016-12-18</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Mobile/" itemprop="url" rel="index"><span itemprop="name">Mobile</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="最近在用swift重构公司的项目，首先踩的就是第三方SDK的坑，因为友盟没有swift集成的相关文档，所以只能摸着石头过河了，再次记录一下自己踩的坑，同时也希望能给需要的人带来帮助"><a href="#最近在用swift重构公司的项目，首先踩的就是第三方SDK的坑，因为友盟没有swift集成的相关文档，所以只能摸着石头过河了，再次记录一下自己踩的坑，同时也希望能给需要的人带来帮助" class="headerlink" title="最近在用swift重构公司的项目，首先踩的就是第三方SDK的坑，因为友盟没有swift集成的相关文档，所以只能摸着石头过河了，再次记录一下自己踩的坑，同时也希望能给需要的人带来帮助"></a>最近在用swift重构公司的项目，首先踩的就是第三方SDK的坑，因为友盟没有swift集成的相关文档，所以只能摸着石头过河了，再次记录一下自己踩的坑，同时也希望能给需要的人带来帮助</h2><h3 id="上代码，首先是友盟app统计"><a href="#上代码，首先是友盟app统计" class="headerlink" title="上代码，首先是友盟app统计"></a>上代码，首先是友盟app统计</h3>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2016/12/18/2016-12-18-umeng_in_swift/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://uonlyliveonce.com/2016/11/06/2016-11-06-ios_uibutton_swift3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Wong">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wong's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/11/06/2016-11-06-ios_uibutton_swift3/" class="post-title-link" itemprop="url">iOS UIButton swift3.0</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2016-11-06 13:15:36" itemprop="dateCreated datePublished" datetime="2016-11-06T13:15:36+08:00">2016-11-06</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Mobile/" itemprop="url" rel="index"><span itemprop="name">Mobile</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="iOS-UIButton-swift3-0"><a href="#iOS-UIButton-swift3-0" class="headerlink" title="iOS UIButton swift3.0"></a>iOS UIButton swift3.0</h3>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2016/11/06/2016-11-06-ios_uibutton_swift3/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://uonlyliveonce.com/2016/11/06/2016-11-06-ios_uitextview_swift3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Wong">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wong's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/11/06/2016-11-06-ios_uitextview_swift3/" class="post-title-link" itemprop="url">iOS UITextView swift3.0</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2016-11-06 09:49:00" itemprop="dateCreated datePublished" datetime="2016-11-06T09:49:00+08:00">2016-11-06</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Mobile/" itemprop="url" rel="index"><span itemprop="name">Mobile</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="iOS-UITextView-swift3-0"><a href="#iOS-UITextView-swift3-0" class="headerlink" title="iOS UITextView swift3.0"></a>iOS UITextView swift3.0</h3>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2016/11/06/2016-11-06-ios_uitextview_swift3/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://uonlyliveonce.com/2016/11/05/2016-11-05-ios-uisegmentedcontrol_swift3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Wong">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wong's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/11/05/2016-11-05-ios-uisegmentedcontrol_swift3/" class="post-title-link" itemprop="url">iOS UISegmentedControl swift3.0</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2016-11-05 13:53:35" itemprop="dateCreated datePublished" datetime="2016-11-05T13:53:35+08:00">2016-11-05</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Mobile/" itemprop="url" rel="index"><span itemprop="name">Mobile</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="iOS-UISegmentedControl-swift3-0"><a href="#iOS-UISegmentedControl-swift3-0" class="headerlink" title="iOS UISegmentedControl swift3.0"></a>iOS UISegmentedControl swift3.0</h3>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2016/11/05/2016-11-05-ios-uisegmentedcontrol_swift3/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Wong</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">45</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">19</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/uonlyliveonce" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;uonlyliveonce" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:u_only_live_once@outlook.com" title="E-Mail → mailto:u_only_live_once@outlook.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Wong</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
